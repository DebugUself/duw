# 怼周刊_v112
~ 预定 190610 2042 发布

-----------------------------------------
...TODO


-----------------------------------------

- 主编: [大妈](http://du.zoomquiet.io/2014-02/ac0-zq/)
- 责编:

## Activity 活性
> 社区当前嗯哼程度


 怼员 | 怼力 | 数值 
---- | ---- | ----
[zoomquiet](https://du.101.camp/PoDU/v0/zoomquiet/) | 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥 | 100.00
[izhangshiying](https://du.101.camp/PoDU/v0/izhangshiying/) | 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥 | 70.42
[simpleowen](https://du.101.camp/PoDU/v0/simpleowen/) | 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥 | 50.70
[gzmichael](https://du.101.camp/PoDU/v0/gzmichael/) | 🔥🔥 | 8.45
[xiaoshizi1024](https://du.101.camp/PoDU/v0/xiaoshizi1024/) | 🔥 | 7.04
[youying0356](https://du.101.camp/PoDU/v0/youying0356/) | 🔥 | 4.23
[hailiange](https://du.101.camp/PoDU/v0/hailiange/) | ... | 0.00


## propose 号召

- [|蠎周刊 |汇集全球蠎事儿 !-)](http://weekly.pychina.org/archives.html)
    + 俺私人嗯哼了5年了
    + 邀请大家一起来, 每周嗯哼
- 每周例怼后, 无论是否列席, 大家都在 `故事->怼印象` 中追加当周 top3 感触



## Achievements 成果 
~ 各种成品/半成品 内部知识作品
### @熊本🐻 -> 怼周刊发布手册S29版
<- [3d[TASK]DUW发布手册S29版 · Issue #706 · DebugUself/du4proto](https://github.com/DebugUself/du4proto/issues/706)

#### S29版简要说明
- S29版怼周刊发布手册,主要的变化是自动化网站发布.为达成此项功能,发布步骤有3个主要变更
	+ trigger 触发
	+ log 记录查询
	+ 小站更新
- 详情步骤见如下

#### S29版变更detail

~ trigger 目录下空文档触发

- repo: du4proto branch: DUW
	+ 来到 repo: du4proto branch: DUW
	+ 来到目录 du4proto/2019
	+ 确认当周怼周刊文字内容填充完毕
	+ 将当周怼周刊草稿 ###_draft.md修改为###.md
	+ commit message书写为"🚀 RELEASE: (#当周怼周会的issue号) ###(当周怼周刊的期数)w pub"
	+ 案例见 ~ [🚀 RELEASE: (#701) 111w pub](https://github.com/DebugUself/du4proto/commit/ac7a3232b420b34b8ffb3a210dc5b8cada8bf9a7)
	+ 来到目录 du4proto/_trigger
	+ 手动添加空文档 deploy.md (注:此步骤旨在部署怼周刊网页版自动化发布)
	+ commit message书写为"🚀 RELEASE: (#当周怼周会的issue号) ###(当周怼周刊的期数)w trigger"
	+ 案例见 ~ [🚀 RELEASE: (#701) 111w trigger](https://github.com/DebugUself/du4proto/commit/5c6e8e3ce8f5c4bd50a38b7bd5790e7fbb27cb62#diff-b2e952116eb611072a997cdebdb0a0d9)


~ logging 发布记录查询

- repo: duw branch: logging
	+ 来到 repo: duw branch: logging
	+ 来到本分支的commit history
	+ 查看自动发布log
	+ 确认当周周刊是否成功发布
		* 发布成功第1种确认方法: 直接查看commit history,如果commit message说"📦 NEW: (crontab) logging auto publish..."即为发布成功.
		* 发布成功第2种确认方法: 查看log脚本中,当周的DUW分支里的.md是否已转移到docs,比如[6月log](https://github.com/DebugUself/duw/commit/4b96979987dd9ea70efc3c4f485c9fe4ef4d1185#diff-5157a5b30e51b75d766b7de7aa953826)里的line 162 ` '../br_DUW/2019/111w.md' -> './docs/111w.md'`,即为111w发布成功.
	+ 案例见 ~ [📦 NEW: (crontab) logging auto publish as 2019-06-04](https://github.com/DebugUself/duw/commit/4b96979987dd9ea70efc3c4f485c9fe4ef4d1185)

~ 怼周刊小站确认
	+ 来到
	+ 确认当周周刊是否成功发布
	+ 案例见 ~ 

#### S29版归档
- 本版手册已收敛于 [怼周刊发布手册S29版](https://github.com/DebugUself/du4proto/wiki/DUW2pubS29)
- 针对本版本的意见请移步至 [7d[TASK] 参与修订怼周刊发布手册S29版](https://github.com/DebugUself/du4proto/issues/708)
      
## Stories 故事 
~ 收集各自无法雷同的怼圈真人故事...

### @DAMA@熊本 -> 怼周刊发布机修正:Webhook Bypass调整

#### 背景 -> 怼周刊网页无法自动发布
<= [190604 熊本 [10:37]*HELP* 111w怼周刊无法触发... ](https://github.com/DebugUself/du4proto/issues/703)

- 111w怼周刊编辑操作时发现,无法发布网页版. 
- 按往常,只要进行如下两步操作,就会触发网页版发布:
	+ 1.将_draft.md更名为.md
	+ 2.在_trigger目录下添加空文件deploy.md
- 操作日志见 ~ [5c6e8e3](https://github.com/DebugUself/du4proto/commit/5c6e8e3ce8f5c4bd50a38b7bd5790e7fbb27cb62)
- @DAMA追踪后,总结事件为
	+ 触发器正确部署 ~ [5c6e8e3](https://github.com/DebugUself/du4proto/commit/5c6e8e3ce8f5c4bd50a38b7bd5790e7fbb27cb62)
	+ 但是对应:
    + 工具分支无自动整理 ~ [Commits · DebugUself/duw](https://github.com/DebugUself/duw/commits/master)
    + 发布仓库无法自动发布 ~ [Commits · DebugUself/duw](https://github.com/DebugUself/duw/commits/master)
        * 对应日志分支也无对应记录 ~ [Commits · DebugUself/duw](https://github.com/DebugUself/duw/commits/logging)

#### 应急方案 -> 手动发布网页版怼周刊
- 基于 [DUW publisheer 怼周刊发布机](https://github.com/DebugUself/du4proto/tree/duw_pub),@DAMA紧急手动发布网页版
- 开放定期脚本无触发时日志输出 ~ [e843975](https://github.com/DebugUself/du4proto/commit/e843975b75c291b6206e1fdc0a1e39aff0e1592d)
- inv pub 自动发布 ~ [6fce65a](https://github.com/DebugUself/du4proto/commit/6fce65a8494c70fce2b99a427cd67f80528fa9f3)
    + 自动非编译更新 ~ 1345ec8e6706fd8e31ffce14712db0f23d1209b4
    + 自动清除触发文件 ~ [3212f21](https://github.com/DebugUself/du4proto/commit/3212f214deaf8ad43b012296e3aafc354ff57a25)


#### 触发失败原因 -> webhook bypass

- 发现 VPS 主机中对应 hooks 日志据错:

```
    trigger @ 2019/06/04 20:40:01
    github-hook->trigger exist, deploy NOW:-)
    /opt/www/debuguself/br_duw_pub/cron4trig2duw.sh: line 40: /opt/www/debuguself/ghbr_logging_duw/2019/06/190604_204001.log: No such file or directory

    ...

    fatal: pathspec '2019/06/*.log' did not match any files
    On branch logging
    Your branch is up-to-date with 'origin/logging'.
    nothing to commit, working directory clean
```

- 是对应日志目录没能事先创建:
- 修复自动目录创建 ~ [👌 IMPROVE: (#703) pubDUW hook log path err. fix · DebugUself/du4proto@c821e08](https://github.com/DebugUself/du4proto/commit/c821e08cdaf6299db3b39b500b29cd065e145218)
- 再次激发 ~ [c6494aa](https://github.com/DebugUself/du4proto/commit/c6494aaa6da77a540e45d09d8602f1b0c1801316)
- 但是 http://hook.duw.zoomquiet.top/ 正常运行, 却没能根据仓库动态生成对应主机端 激发文件,导致整个儿自动化部署无法真正激发

`应急修改`

- 定期脚本直接检测仓库触发文件 ~ [👌 IMPROVE: (#703) bypass webhook base git repo.file trigger · DebugUself/du4proto@51f9400](https://github.com/DebugUself/du4proto/commit/51f9400e7d16cea1991333af2f3a88ae1792087d)
- 果然:
- 触发自动整理: [3b740d7](https://github.com/DebugUself/du4proto/commit/3b740d7d8130e9667d9f2b0a41e41ba1b29bb1b8)
- 自动发布: [4c53a9d](https://github.com/DebugUself/duw/commit/4c53a9deac790a6a211f2ef8717fba75579f95c1)
    + 自动日志: [4b96979](https://github.com/DebugUself/duw/commit/4b96979987dd9ea70efc3c4f485c9fe4ef4d1185)
- 自动恢复激发状态: [2adf1cc](https://github.com/DebugUself/du4proto/commit/2adf1cc4c70692e1d10bac15b030f316fd9a8b15)
- 结果:怼周刊网页自动触发恢复

#### 小结 -> 2个关键
- 最关键的需要修改的脚本是 [du4proto/cron4trig2duw.sh at duw_pub](https://github.com/DebugUself/du4proto/blob/duw_pub/cron4trig2duw.sh),duw发布的一系列脚本都存放在duw_pub分支的[DUW publisheer 怼周刊发布机](https://github.com/DebugUself/du4proto/tree/duw_pub)
- 最需要关注的自动化发布日志在duw仓库的logging分支 ~[Branch:logging Commits · DebugUself/duw](https://github.com/DebugUself/duw/commits/logging),如duw网页版自动发布出现问题,除了在小站直接观察,还可去duw仓库的logging分支查看日志

<img width="800" alt="duwStructure" src="https://user-images.githubusercontent.com/19412465/59022569-91833f80-8880-11e9-9f5d-cf6c9c250979.png">

### impression 怼印象 
~ 例怼中感触最嗯哼的 top3 感想

- `(￣▽￣)`:
    + ...

- 熊本🐻:
    + @ZoomQuiet GraghiQL获取的数据比用Golang QT等更加精准,因为精准,获取数据的成本得到降低. 怼力似乎和以前的怼周刊st服务内容差不多,其意义是,用来衡量怼员在怼圈的活力指数. 
    + @izhangshiying 分享本地发布怼周刊小站的意愿. 被建议建立Issue记录过程. 
    + 困惑:为何选择如是量化指标似乎一直未见故事说明,怎么能证明量化指标不是'拍脑袋'不是'面子工程',需要具体故事的积累. 

### live 怼生活
~ 生活中带有怼范的各种 (投稿后可同时沉淀到 wiki 的2.5 怼生活下)


## Recommedations 推荐 
~ 嗯哼各种怼路上发现的嗯哼...

- 是也乎:
    + [Issue 371 ~蠎周刊 ~汇集全球蠎事儿 ;-)](http://weekly.pychina.org/issue/issue-371.html)


## Postscript 后记 
~ 怼周刊是什么以及为什么和能怎么...

大妈曰过: `参差多态 才是生机`
问题在 `参差` 的行为是无法形成团队的

    Coming together is a beginning; 
    Keeping together is progress; 
    Working together is success!

<--- [Henry Ford](https://www.brainyquote.com/quotes/quotes/h/henryford121997.html)

- 所以, 有了 大妈 随见随怼的持续嗯哼...
- 但是, 想象一年后, 回想几十周前自己作的那些 `图样图森破` 
- 却没现成的资料来出示给后进来嗯哼?
- 不科学, 值得记录的, 就应当有个形式固定下来
- 所以,有了这个 `怼周刊` (Weekly 4 DU)

What is DUW?
Why we make DUW?
What are the possibilities of DUW?

Dama said, variety brings vitality.
But various behaviors may make us hard to cooperate as a team.

    Coming together is a beginning; 
    Keeping together is progress; 
    Working together is success!

<--- [Henry Ford](https://www.brainyquote.com/quotes/quotes/h/henryford121997.html)

That's why Dama keeps on debugging.
However, as time goes by, maybe you would not remember these days clearly and spread your experience difficultly.
What a pity!
The valuable should have a fixed form to be recorded.
That's why we make the Weekly for DU.

